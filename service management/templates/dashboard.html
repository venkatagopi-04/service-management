<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<style>
    @import url('https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,600,700&subset=latin-ext');
html, body {
    height: 100%;
    width: 100%;
}
body {
    margin: 0;
    padding: 0;
    font-family: "Open Sans";
    font-size: 14px;
    font-weight: 400;
    overflow: hidden;
    background-color: #f3f3f3;
    color: #102c58;
}
* {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}
::-webkit-input-placeholder {
    color: #c3c3c3;
}
#addr{
    color:transparent;
}
p {
    color: #ababab;
}
h1 {
    font-size: 24px;
}
h2 {
    font-size: 20px;
}
h3 {
    font-size: 18px;
}
.u-list {
    margin: 0;
    padding: 0;
    list-style: none;
}
.u-input {
    outline: 0;
    border: 1px solid #d0d0d0;
    padding: 5px 10px;
    height: 35px;
    font-size: 12px;
    -webkit-border-radius: 10px;
    border-radius: 10px;
    background-clip: padding-box;
}
.c-badge {
    font-size: 10px;
    font-weight: 700;
    min-width: 20px;
    padding: 5px;
    border-radius: 4px;
    display: block;
    line-height: 0.7;
    color: #fff;
    text-align: center;
    white-space: nowrap;
    background-color: #102c58;
    border: 1px solid #0c2142;
}
.c-badge--red {
    background-color: #f91605;
    border: 1px solid #e01404;
}
.c-badge--blue {
    background-color: #5f9cfd;
    border: 1px solid #468cfd;
}
.c-badge--header-icon {
    position: absolute;
    bottom: -9px;
}
.tooltip {
    width: 120px;
}
.tooltip-inner {
    padding: 8px 10px;
    color: #fff;
    text-align: center;
    background-color: #051835;
    font-size: 12px;
    border-radius: 3px;
}
.tooltip-arrow {
    border-right-color: #051835 !important;
}
.hamburger-toggle {
    position: relative;
    padding: 0;
    background: transparent;
    border: 1px solid transparent;
    cursor: pointer;
    order: 1;
}
.hamburger-toggle [class*='bar-'] {
    display: block;
    background: #102c58;
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
    -webkit-transition: 0.2s ease all;
    transition: 0.2s ease all;
    border-radius: 2px;
    height: 2px;
    width: 24px;
    margin-bottom: 4px;
}
.hamburger-toggle [class*='bar-']:nth-child(2) {
    width: 18px;
}
.hamburger-toggle [class*='bar-']:last-child {
    margin-bottom: 0;
    width: 12px;
}
.hamburger-toggle.is-opened {
    left: 3px;
}
.hamburger-toggle.is-opened [class*='bar-'] {
    background: #102c58;
}
.hamburger-toggle.is-opened .bar-top {
    -webkit-transform: rotate(45deg);
    transform: rotate(45deg);
    -webkit-transform-origin: 15% 15%;
    transform-origin: 15% 15%;
}
.hamburger-toggle.is-opened .bar-mid {
    opacity: 0;
}
.hamburger-toggle.is-opened .bar-bot {
    -webkit-transform: rotate(45deg);
    transform: rotate(-45deg);
    -webkit-transform-origin: 15% 95%;
    transform-origin: 15% 95%;
    width: 24px;
}
.hamburger-toggle:focus {
    outline-width: 0;
}
.header-icons-group {
    display: flex;
    order: 3;
    margin-left: auto;
    height: 100%;
    border-left: 1px solid #ccc;
}
.header-icons-group .c-header-icon:last-child {
    border-right: 0;
}
.c-header-icon {
    position: relative;
    display: flex;
    flex-shrink: 0;
    float: left;
    width: 70px;
    height: 100%;
    align-items: center;
    justify-content: center;
    line-height: 1;
    cursor: pointer;
    border-right: 1px solid #ccc;
}
.c-header-icon svg {
    font-size: 18px;
    line-height: 40px;
}
.c-header-icon--in-circle {
    border: 1px solid #d0d0d0;
    border-radius: 100%;
}
.c-header-icon:hover svg {
    color: #f5642d;
}
.c-header-icon:hover [class*='bar-'] {
    background: #f5642d;
}
.l-header {
    padding-left: 70px;
    position: fixed;
    top: 0;
    right: 0;
    z-index: 10;
    width: 100%;
    background: #fff;
    -webkit-transition: padding 0.5s ease-in-out;
    -moz-transition: padding 0.5s ease-in-out;
    -ms-transition: padding 0.5s ease-in-out;
    -o-transition: padding 0.5s ease-in-out;
    transition: padding 0.5s ease-in-out;
}
.l-header__inner {
    height: 100%;
    width: 100%;
    display: flex;
    height: 70px;
    align-items: center;
    justify-content: stretch;
    border-bottom: 1px solid;
    border-color: #ccc;
}
.sidebar-is-expanded .l-header {
    padding-left: 220px;
}
.c-search {
    display: flex;
    flex-grow: 1;
    height: 100%;
}
.c-search__input {
    border-top-right-radius: 0px;
    border-bottom-right-radius: 0px;
    border-right: 0;
    width: 100%;
    height: 100%;
    border: 0;
    font-size: 14px;
    padding: 0 20px;
    -webkit-transition: all 0.3s ease-in-out;
    -moz-transition: all 0.3s ease-in-out;
    -ms-transition: all 0.3s ease-in-out;
    -o-transition: all 0.3s ease-in-out;
    transition: all 0.3s ease-in-out;
}
.c-dropdown {
    opacity: 0;
    text-align: left;
    position: absolute;
    flex-direction: column;
    display: none;
    width: 300px;
    top: 30px;
    right: -40px;
    background-color: #fff;
    overflow: hidden;
    min-height: 300px;
    border: 1px solid #d0d0d0;
    -webkit-border-radius: 10px;
    border-radius: 10px;
    background-clip: padding-box;
    -webkit-box-shadow: 0px 5px 14px -1px #cecece;
    -moz-box-shadow: 0px 5px 14px -1px #cecece;
    box-shadow: 0px 5px 14px -1px #cecece;
    -webkit-transition: all 0.3s ease-in-out;
    -moz-transition: all 0.3s ease-in-out;
    -ms-transition: all 0.3s ease-in-out;
    -o-transition: all 0.3s ease-in-out;
    transition: all 0.3s ease-in-out;
}
.l-sidebar {
    width: 70px;
    position: absolute;
    z-index: 10;
    left: 0;
    top: 0;
    bottom: 0;
    background: #102c58;
    -webkit-transition: width 0.5s ease-in-out;
    -moz-transition: width 0.5s ease-in-out;
    -ms-transition: width 0.5s ease-in-out;
    -o-transition: width 0.5s ease-in-out;
    transition: width 0.5s ease-in-out;
}
.l-sidebar .logo {
    width: 100%;
    height: 70px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #051835;
}
.l-sidebar .logo .logo__txt {
    font-size: 26px;
    line-height: 1;
    color: #fff;
    text-align: center;
    font-weight: 700;
}
.l-sidebar__content {
    height: 100%;
    position: relative;
}
.sidebar-is-expanded .l-sidebar {
    width: 220px;
}
.c-menu > ul {
    display: flex;
    flex-direction: column;
}
.c-menu > ul .c-menu__item {
    color: #184a98;
    max-width: 100%;
    overflow: hidden;
}
.c-menu > ul .c-menu__item__inner {
    display: flex;
    flex-direction: row;
    align-items: center;
    min-height: 60px;
    position: relative;
    cursor: pointer;
    -webkit-transition: background-color 0.5s ease-in-out;
    -moz-transition: background-color 0.5s ease-in-out;
    -ms-transition: background-color 0.5s ease-in-out;
    -o-transition: background-color 0.5s ease-in-out;
    transition: background-color 0.5s ease-in-out;
}
.c-menu > ul .c-menu__item__inner:before {
    position: absolute;
    content: " ";
    height: 0;
    width: 2px;
    left: 0;
    top: 50%;
    margin-top: -18px;
    background-color: #5f9cfd;
    opacity: 0;
    -webkit-transition: all 0.5s ease-in-out;
    -moz-transition: all 0.5s ease-in-out;
    -ms-transition: all 0.5s ease-in-out;
    -o-transition: all 0.5s ease-in-out;
    transition: all 0.5s ease-in-out;
}
.c-menu > ul .c-menu__item.is-active {
    color: #fff;
}
.c-menu > ul .c-menu__item.is-active .c-menu__item__inner {
    border-left-color: #fff;
    background-color: #1e3e6f;
}
.c-menu > ul .c-menu__item.is-active .c-menu__item__inner svg {
    color: #fff;
}
.c-menu > ul .c-menu__item.is-active .c-menu__item__inner .c-menu-item__title span {
    color: #fff;
}
.c-menu > ul .c-menu__item.is-active .c-menu__item__inner:before {
    height: 36px;
    opacity: 1;
}
.c-menu > ul .c-menu__item:not(.is-active):hover {
    color: #fff;
}
.c-menu > ul .c-menu__item:not(.is-active):hover .c-menu__item__inner {
    background-color: #f5642d;
    border-left-color: #f5642d;
}
.c-menu > ul .c-menu__item svg {
    flex: 0 0 70px;
    font-size: 16px;
    font-weight: normal;
    text-align: center;
    -webkit-transition: all 0.5s ease-in-out;
    -moz-transition: all 0.5s ease-in-out;
    -ms-transition: all 0.5s ease-in-out;
    -o-transition: all 0.5s ease-in-out;
    transition: all 0.5s ease-in-out;
}
.c-menu > ul .c-menu__item .c-menu-item__expand {
    position: relative;
    left: 100px;
    padding-right: 20px;
    color: #fff;
    margin-left: auto;
    -webkit-transition: left 1s ease-in-out;
    -moz-transition: left 1s ease-in-out;
    -ms-transition: left 1s ease-in-out;
    -o-transition: left 1s ease-in-out;
    transition: left 1s ease-in-out;
}
.sidebar-is-expanded .c-menu > ul .c-menu__item .c-menu-item__expand {
    left: 0px;
}
.c-menu > ul .c-menu__item .c-menu-item__title {
    flex-basis: 100%;
    padding-right: 10px;
    position: relative;
    color: #fff;
    left: 220px;
    opacity: 0;
    -webkit-transition: all 0.7s ease-in-out;
    -moz-transition: all 0.7s ease-in-out;
    -ms-transition: all 0.7s ease-in-out;
    -o-transition: all 0.7s ease-in-out;
    transition: all 0.7s ease-in-out;
}
.c-menu > ul .c-menu__item .c-menu-item__title span {
    font-weight: 400;
    font-size: 14px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    -webkit-transition: left 0.5s ease-in-out;
    -moz-transition: left 0.5s ease-in-out;
    -ms-transition: left 0.5s ease-in-out;
    -o-transition: left 0.5s ease-in-out;
    transition: left 0.5s ease-in-out;
}
.sidebar-is-expanded .c-menu > ul .c-menu__item .c-menu-item__title {
    left: 0px;
    opacity: 1;
}
.c-menu > ul .c-menu__item .c-menu__submenu {
    background-color: #051835;
    padding: 15px;
    font-size: 12px;
    display: none;
}
.c-menu > ul .c-menu__item .c-menu__submenu li {
    padding-bottom: 15px;
    margin-bottom: 15px;
    border-bottom: 1px solid;
    border-color: #072048;
    color: #5f9cfd;
}
.c-menu > ul .c-menu__item .c-menu__submenu li:last-child {
    margin: 0;
    padding: 0;
    border: 0;
}
main.l-main {
    width: 100%;
    height: 100%;
    padding: 70px 0 0 70px;
    -webkit-transition: padding 0.5s ease-in-out;
    -moz-transition: padding 0.5s ease-in-out;
    -ms-transition: padding 0.5s ease-in-out;
    -o-transition: padding 0.5s ease-in-out;
    transition: padding 0.5s ease-in-out;
}
main.l-main .content-wrapper {
    padding: 25px;
    height: 100%;
    overflow: auto;
}
main.l-main .content-wrapper .page-content {
    border-top: 1px solid #d0d0d0;
    padding-top: 25px;
    color: #ababab;
}
main.l-main .content-wrapper--with-bg .page-content {
    background: #fff;
    border-radius: 3px;
    border: 1px solid #d0d0d0;
    padding: 25px;
}
main.l-main .page-title {
    font-weight: 400;
    margin-top: 0;
    margin-bottom: 25px;
}
.sidebar-is-expanded main.l-main {
    padding-left: 220px;
}

/* General Table Styles */
table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
}

th, td {
    padding: 10px;
    text-align: left;
}

thead {
    background-color: #3498db; /* Blue color for the header background */
    color: #fff; /* White text color for the header */
}

/* Alternating row colors for better readability */
tbody tr:nth-child(even) {
    background-color: #ecf0f1; /* Light blue color for even rows */
}

/* Completed Tasks Table Styles */
table.completed-tasks-table th,
table.completed-tasks-table td {
    border: 1px solid #3498db; /* Blue border for completed tasks table */
}

/* Buttons inside the table */
button, a {
    padding: 5px 10px;
    background-color: #3498db; /* Blue color for buttons */
    color: #fff; /* White text color for buttons */
    text-decoration: none;
    border: none;
    cursor: pointer;
}

button:hover, a:hover {
    background-color: #2980b9; /* Darker blue color on hover for buttons */
}

/* Optional: Add some spacing between the tables */
h2 {
    margin-top: 20px;
}


</style>
<body class="sidebar-is-reduced">
    <header class="l-header">
      <div class="l-header__inner clearfix">

        {% if current_user.role == 0 %}

        <div class="c-header-icon js-hamburger">
            <div class="hamburger-toggle"><span class="bar-top"></span><span class="bar-mid"></span><span class="bar-bot"></span></div>
          </div>

          {% endif %}

          <script>

            function searchTables(tableIds) {
    

                
                var input, filter, tr, td, i, j, txtValue;
                input = document.getElementById("searchInput");
                filter = input.value.toUpperCase();
        
                for (var k = 0; k < tableIds.length; k++) {
                    var table = document.getElementById(tableIds[k]);
                    tr = table.getElementsByTagName("tr");
        
                    for (i = 1; i < tr.length; i++) {
                        let found = false;
                        tds = tr[i].getElementsByTagName("td");
                        for (j = 0; j < tds.length; j++) {
                            td = tds[j];
                            if (td) {
                                txtValue = td.textContent || td.innerText;
                                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                    found = true;
                                    break;
                                }
                            }
                        }
                        if (found) {
                            tr[i].style.display = "";
                        } else {
                            tr[i].style.display = "none";
                        }
                    }
                }
            }
        </script>
        <div class="c-search">
            <div class="c-search">
                <div class="c-search">
                    <input type="text" id="searchInput" placeholder="Search..." class="c-search__input u-input" onkeyup="searchTables(['taskTable', 'completedTable'])">
                </div>
                
            </div>
            
        </div>
        <div class="header-icons-group">
          <div class="c-header-icon logout"><a href="{{ url_for('logout') }}"><i class="fa fa-power-off"></i></a></div>
        </div>
      </div>
    </header>
    <div class="l-sidebar">
      <div class="logo">
        <div class="logo__txt"></div>
      </div>
      <div class="l-sidebar__content">
        <nav class="c-menu js-menu">
          <ul class="u-list">

            {% if current_user.role == 0 %}


            <li class="c-menu__item is-active" data-toggle="tooltip" title="Add task">
                 <div class="c-menu__item__inner">  <a href="{{ url_for('add_task') }}">  <i class="fa fa-plus"></i> </a>
                <div class="c-menu-item__title"><span>Add task</span> </div>    
              
              {% endif %}
            </div>
          </ul>
        </nav>
      </div>
    </div>
  </body>
  <main class="l-main">
    <div class="content-wrapper content-wrapper--with-bg">
      <h1 class="page-title">Dashboard</h1>
      <div class="page-content">
		
		
		<h1 style="font-size: 50px; font-weight: 30px; color: crimson; font-style: oblique;">Welcome, {{ current_user.username }}!</h1>



<h2>Your Tasks:</h2>
<table border="1" id="taskTable">
{% if tasks %}


    <thead>
        <tr>
            {% if current_user.role == 1 %}
                <th>Title</th>
                <th>Due Date</th>
                <th>Description</th>
                <th>User ID</th>
                <th>User Name</th>
                <th>Address</th>
                <th>Actions</th>
            {% endif %}
            {% if current_user.role == 0 %}
                <th>Title</th>
                <th>Description</th>
                <th>Due Date</th>
                <th colspan="2">Actions</th>
            {% endif %}
            
        </tr>
    </thead>
    <tbody>
        {% for task in tasks %}
            <tr>
                <tr>
                    {% if current_user.role == 1 %}
                    <td>{{ task.title }}</td>
                    <td>{{ task.due_date }}</td>
                    <td>{{ task.description }}</td>
                    <td>{{ task.user_id }}</td>
                    <td>{{ task.username }}</td>
                    <td id="addr">
                        <a   href="https://www.google.com/maps/search/?api=1&query={{ task.address }}" target="_blank">
                            {{ task.address }}
                        </a>
                    </td>
                    
                    
                    <td>
                        <form method="POST" action="{{ url_for('complete_task', task_id=task.id) }}">
                            <button type="submit">Complete</button>
                        </form>
                    </td>
                {% endif %}

                
                {% if current_user.role == 0 %}
                <td>{{ task.title }}</td>
                <td>{{ task.description }}</td>
                <td>{{ task.due_date }}</td>
                <td><a href="{{ url_for('edit_task', task_id=task.id) }}">edit</a></td>
                <td><a href="#" onclick="confirmDelete('{{ url_for('delete_task', task_id=task.id) }}')">delete</a></td>
                {% endif %}
            </tr>
        {% endfor %}
        
    </tbody>
</table>
{% else %}
    <p>You don't have any running tasks.</p>
{% endif %}


<h2>Completed Tasks:</h2>

<table border="1" id="completedTable">
    {% if completed_tasks %}
    <thead>
        <tr>
            {% if current_user.role == 1 %}
                <th>Title</th>
                <th>Due Date</th>
                <th>Description</th>
                <th>User ID</th>
                <th>User Name</th>
                <th>Address</th>
            {% endif %}
            {% if current_user.role == 0 %}
                <th>Title</th>
                <th>Description</th>
                <th>Due Date</th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
        {% for task in completed_tasks %}
            <tr>
                {% if current_user.role == 1 %}
                    <td>{{ task.title }}</td>
                    <td>{{ task.due_date }}</td>
                    <td>{{ task.description }}</td>
                    <td>{{ task.user_id }}</td>
                    <td>{{ task.username }}</td>
                    <td>{{ task.address }}</td>
                {% endif %}
                {% if current_user.role == 0 %}
                    <td>{{ task.title }}</td>
                    <td>{{ task.description }}</td>
                    <td>{{ task.due_date }}</td>
                {% endif %}
            </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
    <p>No completed tasks available.</p>
{% endif %}






	  </div>
    </div>
  </main>


  

  
 <script>
    let Dashboard = (() => {
  let global = {
    tooltipOptions: {
      placement: "right",
    },
    menuClass: ".c-menu",
  };

  let menuChangeActive = (el) => {
    let hasSubmenu = $(el).hasClass("has-submenu");
    $(global.menuClass + " .is-active").removeClass("is-active");
    $(el).addClass("is-active");

    // if (hasSubmenu) {
    // 	$(el).find("ul").slideDown();
    // }
  };

  let sidebarChangeWidth = () => {
    let $menuItemsTitle = $("li .menu-item__title");

    $("body").toggleClass("sidebar-is-reduced sidebar-is-expanded");
    $(".hamburger-toggle").toggleClass("is-opened");

    if ($("body").hasClass("sidebar-is-expanded")) {
      $('[data-toggle="tooltip"]').tooltip("destroy");
    } else {
      $('[data-toggle="tooltip"]').tooltip(global.tooltipOptions);
    }
  };

  return {
    init: () => {
      $(".js-hamburger").on("click", sidebarChangeWidth);

      $(".js-menu li").on("click", (e) => {
        menuChangeActive(e.currentTarget);
      });

      $('[data-toggle="tooltip"]').tooltip(global.tooltipOptions);
    },
  };
})();

Dashboard.init();



</script>
<script>
    function confirmDelete(deleteUrl, taskTitle) {
        var confirmation = confirm("Are you sure you want to delete the task '" + taskTitle + "'?");
        if (confirmation) {
            window.location.href = deleteUrl;
        }
    }
</script>

